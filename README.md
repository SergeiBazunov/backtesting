# ADA MFI Backtesting

Проект для исследования торговой стратегии по **Money Flow Index** (MFI) на 30-минутном графике **ADA/USDT**. 

Стратегия:
* вход Long, когда MFI ≤ 10;
* тейк-профит (TP) — +1.5 %;
* стоп-лосс (SL) — -9 %;
* один добор (scale-in) по цене −4 % от первой покупки;
* после добора TP переносится в безубыток + 0.10 %;
* максимум одна сделка в день.

Проект построен на **Backtrader**, использует **Poetry** для управления зависимостями и позволяет:
* автоматически скачивать исторические данные Binance;
* гибко настраивать параметры в `backtesting/config.py`;
* проводить бэктест и получать расширенную статистику отчёта;
* выполнять быструю оптимизацию параметров на тренировочном окне.

---

## 1. Установка

```bash
# 1. Клонируйте репозиторий
 git clone https://github.com/SergeiBazunov/backtesting.git
 cd backtesting

# 2. Установите Poetry (если ещё нет)
 pip install --user poetry

# 3. Установите зависимости проекта
 poetry install
```

Python ≥ 3.10.

> Windows-пользователям: убедитесь, что при работе с многопоточностью применяется метод запуска *spawn* (уже настроено в коде).

---

## 2. Быстрый старт

1. Отредактируйте при необходимости `backtesting/config.py` — задайте символ, размер позиции, период теста и пр.
2. Запустите скрипт:

```bash
poetry run python backtesting/run_backtest.py
```

При первом запуске данные автоматически скачаются в `backtesting/data/` и сохранятся в CSV.

### Оптимизация

```bash
poetry run python backtesting/optimize.py
```

Скрипт выполнит грид-поиск с параллельным запуском до указанного числа процессов (CPUs).

---

## 3. Структура проекта

```
backtesting/
 ├─ config.py          # все параметры стратегии
 ├─ data/              # кэш исторических данных (CSV)
 ├─ indicators/
 │   └─ mfi.py         # fallback-реализация MFI
 ├─ strategies/
 │   └─ ada_mfi.py     # логика стратегии
 ├─ run_backtest.py    # одиночный бэктест + отчёт
 └─ optimize.py        # грид-поиск параметров
```

---

## 4. Кастомизация

* Измените тайм-фрейм или символ напрямую в `config.py`.
* Чтобы торговать фиксированной суммой в долларах, задайте `POSITION_VALUE_USD`,
  иначе будет использовано количество `POSITION_SIZE`.
* Параметры комиссии, периода оптимизации и количества ядер также настраиваются в конфиге.

---

## 5. Лицензия

MIT License 